<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸é¾™å¹³æ°‘ç”µç«ç‚¹å•</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- ç®€åŒ–çš„äº‘å­˜å‚¨SDK -->
    <script src="https://cdn.jsdelivr.net/npm/lucide@0.544.0/dist/umd/lucide.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding-bottom: 70px;
        }
        
        /* æ³¨å†Œ/ç™»å½•å¼¹çª— */
        .modal {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .modal-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
            color: #FFD700;
        }
        
        .modal-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .modal-select {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .modal-btn {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background: linear-gradient(45deg, #FF512F, #DD2476);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(221, 36, 118, 0.6);
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }
        
        /* å¤´éƒ¨ */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #ff8a00, #da1b60);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
        }
        
        /* åº•éƒ¨å¯¼èˆª */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .nav-item.active {
            color: #FFD700;
        }
        
        .nav-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        /* é¡µé¢å†…å®¹ */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* ä¸»é¡µ */
        .orders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .order-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }
        
        .order-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .order-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #FFD700;
        }
        
        .order-price-range {
            font-size: 1rem;
            color: #ff6b6b;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .order-original-price {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: line-through;
            margin-bottom: 5px;
        }
        
        .order-desc {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 15px;
        }
        
        .order-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .order-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }
        
        /* åˆ†ç±»é¡µé¢ */
        .categories {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .category {
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .category.active {
            background: rgba(255, 215, 0, 0.3);
            color: #FFD700;
        }
        
        /* æ¶ˆæ¯é¡µé¢ */
        .contact-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            text-align: center;
        }
        
        .wechat-id {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #FFD700;
            font-weight: bold;
        }
        
        .contact-notice {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            line-height: 1.5;
            margin-top: 20px;
        }
        
        /* æˆ‘çš„é¡µé¢ */
        .profile {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-right: 20px;
            overflow: hidden;
        }
        
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-info {
            flex: 1;
        }
        
        .user-info h2 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .user-info p {
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* é€€å‡ºç™»å½•æŒ‰é’® */
        #logoutBtn {
            width: auto;
            padding: 8px 15px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        .review-status {
            margin-top: 30px;
        }
        
        .status-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .status-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #FFD700;
        }
        
        .status-desc {
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* ä¸‹å•å¼¹çª— */
        .order-modal {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .order-modal-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .order-modal-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            color: #FFD700;
        }
        
        .specs-modal {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .spec-modal {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .spec-modal:hover {
            background: rgba(255, 215, 0, 0.3);
        }
        
        .spec-modal.active {
            background: rgba(255, 215, 0, 0.5);
            color: #FFD700;
        }
        
        .spec-name {
            flex: 1;
            text-align: left;
        }
        
        .spec-price {
            font-weight: bold;
            color: #ff6b6b;
        }
        
        /* æ”¯ä»˜å¼¹çª— */
        .payment-modal {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .payment-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .payment-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #FFD700;
        }
        
        .payment-amount {
            font-size: 1.8rem;
            margin: 20px 0;
            color: #ff6b6b;
            font-weight: bold;
        }
        
        .payment-notice {
            margin: 20px 0;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }
        
        /* å®¡æ ¸å¼¹çª— */
        .review-modal {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .review-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .review-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #FFD700;
        }
        
        .review-message {
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        /* åå°ç®¡ç† */
        .admin-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 100;
        }
        
        .admin-btn {
            padding: 8px 15px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .admin-modal {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        .admin-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
            color: #FFD700;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .admin-header h2 {
            margin: 0;
        }
        
        .refresh-btn {
            padding: 8px 15px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .refresh-btn:hover {
            background: #1976D2;
            transform: translateY(-2px);
        }
        
        .refresh-btn:active {
            transform: translateY(0);
        }
        
        .admin-section {
            margin-bottom: 30px;
        }
        
        .admin-section h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #FFD700;
        }
        
        .user-list, .order-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .user-item, .order-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
        }
        
        .order-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .approve-btn, .reject-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .approve-btn {
            background: #4CAF50;
            color: white;
        }
        
        .reject-btn {
            background: #f44336;
            color: white;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #FFD700;
            animation: spin 1s ease-in-out infinite;
        }
        
        .loading-text {
            margin-top: 15px;
            text-align: center;
            color: white;
            font-size: 1.1rem;
        }
        
        /* ä¸‹å•åŠ è½½åŠ¨ç”» */
        .order-loading {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
        }
        
        .order-loading-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .order-loading-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #FFD700;
        }
        
        .order-loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #FFD700;
            margin: 0 auto 20px;
            animation: spin 1s ease-in-out infinite;
        }
        
        .order-loading-text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .orders-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .profile {
                flex-direction: column;
                text-align: center;
            }
            
            .avatar {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .admin-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .refresh-btn {
                align-self: stretch;
            }
        }
    </style>
</head>
<body>
    <!-- åˆå§‹åŒ–åŠ è½½åŠ¨ç”» -->
    <div class="loading" id="loading">
        <div style="text-align: center;">
            <div class="loading-spinner"></div>
            <div class="loading-text">ç³»ç»Ÿåˆå§‹åŒ–ä¸­...</div>
        </div>
    </div>
    
    <!-- ä¸‹å•åŠ è½½åŠ¨ç”» -->
    <div class="order-loading" id="orderLoading">
        <div class="order-loading-content">
            <div class="order-loading-spinner"></div>
            <h2 class="order-loading-title">è®¢å•æäº¤ä¸­</h2>
            <p class="order-loading-text">æ­£åœ¨ä¿å­˜è®¢å•æ•°æ®åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¨å€™...</p>
        </div>
    </div>
    
    <!-- æ¸¸æˆåç§°è¾“å…¥å¼¹çª— -->
    <div class="modal" id="gameNameModal">
        <div class="modal-content">
            <h2 class="modal-title">è¾“å…¥æ¸¸æˆåç§°</h2>
            <input type="text" class="modal-input" id="gameNameInput" placeholder="è¯·è¾“å…¥æ¸¸æˆåç§°">
            <button class="modal-btn" id="gameNameConfirmBtn">ä¸‹ä¸€æ­¥</button>
        </div>
    </div>
    
    <!-- åŒºæœé€‰æ‹©å¼¹çª— -->
    <div class="modal" id="serverModal">
        <div class="modal-content">
            <h2 class="modal-title">é€‰æ‹©åŒºæœ</h2>
            <select class="modal-select" id="serverSelect">
                <option value="">è¯·é€‰æ‹©åŒºæœ</option>
                <option value="QQåŒº">QQåŒº</option>
                <option value="å¾®ä¿¡åŒº">å¾®ä¿¡åŒº</option>
            </select>
            <button class="modal-btn" id="serverConfirmBtn">è¿›å…¥</button>
        </div>
    </div>
    
    <!-- ä¸»å®¹å™¨ -->
    <div class="container" id="mainContainer">
        <header>
            <h1>æ¬¢è¿æ¥åˆ°æ¸¸é¾™å¹³æ°‘ç”µç«ç‚¹å•</h1>
            <div class="subtitle">å…¨ç½‘æœ€æ€§ä»·æ¯”çš„é¡¶å°–æŠ¤</div>
        </header>
        
        <!-- ä¸»é¡µ -->
        <div class="page active" id="homePage">
            <h2>çƒ­é—¨è®¢å•</h2>
            <div class="orders-grid" id="ordersGrid">
                <!-- è®¢å•å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- åˆ†ç±»é¡µé¢ -->
        <div class="page" id="categoryPage">
            <h2>åˆ†ç±»</h2>
            <div class="categories">
                <div class="category active" data-category="all">å…¨éƒ¨</div>
                <div class="category" data-category="equipment">è£…å¤‡</div>
                <div class="category" data-category="skin">çš®è‚¤</div>
                <div class="category" data-category="vip">VIP</div>
                <div class="category" data-category="other">å…¶ä»–</div>
            </div>
            
            <div class="orders-grid" id="categoryOrdersGrid">
                <!-- åˆ†ç±»è®¢å•å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- æ¶ˆæ¯é¡µé¢ -->
        <div class="page" id="messagePage">
            <h2>è”ç³»å®¢æœ</h2>
            <div class="contact-info">
                <div class="wechat-id">å¾®ä¿¡å·: youlong6665</div>
                <div class="contact-notice">
                    å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æ·»åŠ ä»¥ä¸Šå¾®ä¿¡å·è”ç³»å®¢æœ<br>
                    å·¥ä½œæ—¶é—´ï¼šæ¯å¤© 7:00 - 23:00<br>
                    æˆ‘ä»¬ä¼šåœ¨15åˆ†é’Ÿå†…å›å¤æ‚¨
                </div>
            </div>
        </div>
        
        <!-- æˆ‘çš„é¡µé¢ -->
        <div class="page" id="profilePage">
            <h2>æˆ‘çš„ä¿¡æ¯</h2>
            <div class="profile">
                <div class="avatar">
                    <!-- éšæœºå¤´åƒ -->
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MCIgaGVpZ2h0PSI4MCIgdmlld0JveD0iMCAwIDgwIDgwIj48Y2lyY2xlIGN4PSI0MCIgY3k9IjQwIiByPSI0MCIgZmlsbD0iIzMzYzhmZiIvPjxjaXJjbGUgY3g9IjQwIiBjeT0iMzAiIHI9IjE1IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTI1IDYwIEEyMCAyMCA0IDAgMSA1NSA2MCBMNTUgNzAgQTIwIDIwIDAgMCAxIDI1IDcwIFoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=" alt="ç”¨æˆ·å¤´åƒ">
                </div>
                <div class="user-info">
                    <h2 id="userName">ç”¨æˆ·å</h2>
                    <p id="userServer">åŒºæœ: QåŒº</p>
                    <button class="modal-btn" id="logoutBtn">é€€å‡ºç™»å½•</button>
                </div>
            </div>
            
            <div class="review-status">
                <h3>æˆ‘çš„è®¢å•</h3>
                <div id="userOrdersList">
                    <!-- ç”¨æˆ·è®¢å•å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨å¯¼èˆª -->
        <div class="bottom-nav">
            <div class="nav-item active" data-page="homePage">
                <div class="nav-icon">ğŸ </div>
                <div>ä¸»é¡µ</div>
            </div>
            <div class="nav-item" data-page="categoryPage">
                <div class="nav-icon">ğŸ“‚</div>
                <div>åˆ†ç±»</div>
            </div>
            <div class="nav-item" data-page="messagePage">
                <div class="nav-icon">ğŸ’¬</div>
                <div>æ¶ˆæ¯</div>
            </div>
            <div class="nav-item" data-page="profilePage">
                <div class="nav-icon">ğŸ‘¤</div>
                <div>æˆ‘çš„</div>
            </div>
        </div>
    </div>
    
    <!-- ä¸‹å•å¼¹çª— -->
    <div class="order-modal" id="orderModal">
        <div class="order-modal-content">
            <h2 class="order-modal-title" id="orderModalTitle">é€‰æ‹©è§„æ ¼</h2>
            <div class="specs-modal" id="specsModal">
                <!-- è§„æ ¼å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <button class="modal-btn" id="confirmOrderBtn">ç¡®è®¤ä¸‹å•</button>
            <button class="modal-btn" style="background: #6c757d; margin-top: 10px;" id="cancelOrderBtn">å–æ¶ˆ</button>
        </div>
    </div>
    
    <!-- æ”¯ä»˜å¼¹çª— -->
    <div class="payment-modal" id="paymentModal">
        <div class="payment-content">
            <h2 class="payment-title">è¯·å®Œæˆæ”¯ä»˜</h2>
            <div class="payment-amount" id="paymentAmount">Â¥0.00</div>
            <div class="payment-notice">
                è¯·æ·»åŠ å®¢æœå¾®ä¿¡å®Œæˆæ”¯ä»˜<br>
                å¾®ä¿¡å·ã€é•¿æŒ‰å¤åˆ¶ã€‘: <strong>youlong6665</strong><br>
                æ”¯ä»˜é‡‘é¢: <span id="paymentAmountText">Â¥0.00</span>
            </div>
            <button class="modal-btn" id="paymentConfirmBtn" style="margin-top: 20px;">å¥½çš„</button>
            <button class="modal-btn" style="background: #6c757d; margin-top: 10px;" id="paymentCloseBtn">å–æ¶ˆ</button>
        </div>
    </div>
    
    <!-- å®¡æ ¸å¼¹çª— -->
    <div class="review-modal" id="reviewModal">
        <div class="review-content">
            <h2 class="review-title" id="reviewTitle">å®¡æ ¸é€šçŸ¥</h2>
            <p class="review-message" id="reviewMessage">æ‚¨çš„è®¢å•æ­£åœ¨å®¡æ ¸ä¸­</p>
            <button class="modal-btn" id="reviewCloseBtn">ç¡®å®š</button>
        </div>
    </div>
    
    <!-- åå°ç®¡ç† -->
    <div class="admin-panel">
        <button class="admin-btn" id="adminBtn">ç®¡ç†åå°</button>
    </div>
    
    <!-- åå°å¯†ç éªŒè¯ -->
    <div class="modal" id="adminPasswordModal">
        <div class="modal-content relative">
            <button class="absolute top-2 right-2 text-white text-2xl" id="adminPasswordCloseBtn">&times;</button>
            <h2 class="modal-title">åå°ç®¡ç†</h2>
            <p style="text-align: center; margin-bottom: 15px;">è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç </p>
            <input type="password" class="modal-input" id="adminPassword" placeholder="è¯·è¾“å…¥å¯†ç ">
            <button class="modal-btn" id="adminPasswordBtn">è¿›å…¥</button>
        </div>
    </div>
    
    <div class="admin-modal" id="adminModal">
        <div class="admin-content">
            <div class="admin-header">
                <h2 class="admin-title">åå°ç®¡ç†ç³»ç»Ÿ</h2>
                <button class="refresh-btn" id="adminRefreshBtn">
                    <i class="fa fa-refresh" style="margin-right: 5px;"></i>åˆ·æ–°æ•°æ®
                </button>
            </div>
            
            <div class="admin-section">
                <h3>ç”¨æˆ·åˆ—è¡¨</h3>
                <div class="user-list" id="userList">
                    <!-- ç”¨æˆ·åˆ—è¡¨å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <div class="admin-section">
                <h3>è®¢å•åˆ—è¡¨</h3>
                <div class="order-list" id="adminOrderList">
                    <!-- è®¢å•åˆ—è¡¨å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <button class="modal-btn" id="adminCloseBtn">å…³é—­</button>
        </div>
    </div>

    <script>
        // GitHubäº‘å­˜å‚¨é…ç½®
        const cloudConfig = {
            storageType: 'github',
            githubToken: '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',
            githubRepo: 'iill392/game-order-system',
            githubBranch: 'main',
            apiEndpoint: ''
        };

        // GitHubå­˜å‚¨ç®¡ç†å™¨
        const storageManager = {
            // GitHub APIåŸºç¡€URL
            apiBase: 'https://api.github.com',
            
            // è·å–æ–‡ä»¶å†…å®¹
            async getFileContent(path) {
                try {
                    const response = await Promise.race([
                        fetch(`${this.apiBase}/repos/${cloudConfig.githubRepo}/contents/${path}`, {
                            headers: {
                                'Authorization': `token ${cloudConfig.githubToken}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'X-GitHub-Api-Version': '2022-11-28'
                            }
                        }),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('è¿æ¥è¶…æ—¶')), 10000))
                    ]);
                    
                    if (response.ok) {
                        const data = await response.json();
                        return {
                            content: JSON.parse(this.base64Decode(data.content)),
                            sha: data.sha
                        };
                    } else if (response.status === 404) {
                        return null;
                    } else {
                        console.warn('GitHub APIé”™è¯¯:', response.status, await response.text());
                        return null;
                    }
                } catch (error) {
                    console.error('è·å–GitHubæ–‡ä»¶å¤±è´¥:', error);
                    return null;
                }
            },
            
            // ä¿å­˜æ–‡ä»¶å†…å®¹
            async saveFileContent(path, content, sha = null) {
                try {
                    const body = {
                        message: `æ›´æ–°${path} - ${new Date().toISOString()}`,
                        content: this.base64Encode(JSON.stringify(content, null, 2)),
                        branch: cloudConfig.githubBranch
                    };
                    
                    if (sha) {
                        body.sha = sha;
                    }
                    
                    const response = await fetch(`${this.apiBase}/repos/${cloudConfig.githubRepo}/contents/${path}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${cloudConfig.githubToken}`,
                            'Content-Type': 'application/json',
                            'Accept': 'application/vnd.github.v3+json',
                            'X-GitHub-Api-Version': '2022-11-28'
                        },
                        body: JSON.stringify(body)
                    });
                    
                    if (!response.ok) {
                        console.warn('GitHubä¿å­˜å¤±è´¥:', response.status, await response.text());
                        return false;
                    }
                    
                    return true;
                } catch (error) {
                    console.error('ä¿å­˜GitHubæ–‡ä»¶å¤±è´¥:', error);
                    return false;
                }
            },
            
            // å®‰å…¨åœ°ç¼–ç å­—ç¬¦ä¸²ä¸ºbase64ï¼ˆæ”¯æŒä¸­æ–‡ï¼‰
            base64Encode(str) {
                try {
                    // æ–¹æ³•1ï¼šä½¿ç”¨TextEncoderï¼ˆç°ä»£æµè§ˆå™¨ï¼‰
                    const encoder = new TextEncoder();
                    const encoded = encoder.encode(str);
                    let binary = '';
                    const len = encoded.length;
                    for (let i = 0; i < len; i++) {
                        binary += String.fromCharCode(encoded[i]);
                    }
                    return btoa(binary);
                } catch (error) {
                    console.warn('TextEncoderå¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•:', error);
                    // æ–¹æ³•2ï¼šå¤‡ç”¨æ–¹æ³•
                    try {
                        // å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç 
                        const utf8Bytes = unescape(encodeURIComponent(str));
                        return btoa(utf8Bytes);
                    } catch (e) {
                        console.error('å¤‡ç”¨ç¼–ç æ–¹æ³•ä¹Ÿå¤±è´¥:', e);
                        // æ–¹æ³•3ï¼šæœ€ç®€å•çš„å›é€€æ–¹æ¡ˆ
                        return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function(match, p1) {
                            return String.fromCharCode('0x' + p1);
                        }));
                    }
                }
            },
            
            // å®‰å…¨åœ°è§£ç base64ä¸ºå­—ç¬¦ä¸²ï¼ˆæ”¯æŒä¸­æ–‡ï¼‰
            base64Decode(base64) {
                try {
                    // æ–¹æ³•1ï¼šä½¿ç”¨TextDecoderï¼ˆç°ä»£æµè§ˆå™¨ï¼‰
                    const binary = atob(base64);
                    const bytes = new Uint8Array(binary.length);
                    for (let i = 0; i < binary.length; i++) {
                        bytes[i] = binary.charCodeAt(i);
                    }
                    const decoder = new TextDecoder();
                    return decoder.decode(bytes);
                } catch (error) {
                    console.warn('TextDecoderå¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•:', error);
                    // æ–¹æ³•2ï¼šå¤‡ç”¨æ–¹æ³•
                    try {
                        const utf8Bytes = atob(base64);
                        let result = '';
                        for (let i = 0; i < utf8Bytes.length; i++) {
                            result += String.fromCharCode(utf8Bytes.charCodeAt(i) & 255);
                        }
                        return decodeURIComponent(escape(result));
                    } catch (e) {
                        console.error('å¤‡ç”¨è§£ç æ–¹æ³•ä¹Ÿå¤±è´¥:', e);
                        // æ–¹æ³•3ï¼šæœ€ç®€å•çš„å›é€€æ–¹æ¡ˆ
                        return decodeURIComponent(atob(base64).split('').map(function(c) {
                            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                        }).join(''));
                    }
                }
            },
            
            // ä¿å­˜æ•°æ®
            async save(key, data) {
                try {
                    if (cloudConfig.storageType === 'github' && cloudConfig.githubToken && cloudConfig.githubRepo) {
                        const path = `data/${key}.json`;
                        const existingData = await this.getFileContent(path);
                        const sha = existingData ? existingData.sha : null;
                        const success = await this.saveFileContent(path, data, sha);
                        
                        if (success) {
                            console.log(`æ•°æ®å·²ä¿å­˜åˆ°GitHub: ${key}`);
                            // åŒæ—¶åœ¨æœ¬åœ°ä¿å­˜ä¸€ä»½å¤‡ä»½
                            try {
                                localStorage.setItem(key, JSON.stringify(data));
                            } catch (e) {
                                console.warn('æœ¬åœ°å¤‡ä»½ä¿å­˜å¤±è´¥:', e);
                            }
                            return true;
                        } else {
                            console.warn('GitHubä¿å­˜å¤±è´¥ï¼Œå›é€€åˆ°æœ¬åœ°å­˜å‚¨');
                            localStorage.setItem(key, JSON.stringify(data));
                            return true;
                        }
                    } else if (cloudConfig.storageType === 'customApi' && cloudConfig.apiEndpoint) {
                        const response = await fetch(cloudConfig.apiEndpoint + '/save', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ key, data })
                        });
                        return response.ok;
                    } else {
                        localStorage.setItem(key, JSON.stringify(data));
                        console.log(`æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°: ${key}`);
                        return true;
                    }
                } catch (error) {
                    console.error('ä¿å­˜æ•°æ®å¤±è´¥:', error);
                    try {
                        localStorage.setItem(key, JSON.stringify(data));
                        console.log('å·²å›é€€åˆ°æœ¬åœ°å­˜å‚¨');
                        return true;
                    } catch (e) {
                        console.error('æœ¬åœ°å­˜å‚¨ä¹Ÿå¤±è´¥:', e);
                        return false;
                    }
                }
            },

            // è·å–æ•°æ®
            async get(key) {
                try {
                    if (cloudConfig.storageType === 'github' && cloudConfig.githubToken && cloudConfig.githubRepo) {
                        const path = `data/${key}.json`;
                        const data = await this.getFileContent(path);
                        
                        if (data) {
                            console.log(`ä»GitHubè·å–æ•°æ®: ${key}`);
                            // åŒæ—¶åœ¨æœ¬åœ°ä¿å­˜ä¸€ä»½ç¼“å­˜
                            try {
                                localStorage.setItem(key, JSON.stringify(data.content));
                            } catch (e) {
                                console.warn('æœ¬åœ°ç¼“å­˜ä¿å­˜å¤±è´¥:', e);
                            }
                            return data.content;
                        } else {
                            console.log(`GitHubä¸Šæ²¡æœ‰æ‰¾åˆ°æ•°æ®: ${key}ï¼Œå°è¯•æœ¬åœ°å­˜å‚¨`);
                            const localData = localStorage.getItem(key);
                            if (localData) {
                                console.log(`ä»æœ¬åœ°è·å–æ•°æ®: ${key}`);
                                return JSON.parse(localData);
                            }
                            return null;
                        }
                    } else if (cloudConfig.storageType === 'customApi' && cloudConfig.apiEndpoint) {
                        const response = await fetch(cloudConfig.apiEndpoint + '/get?key=' + key);
                        if (response.ok) {
                            return await response.json();
                        }
                        return null;
                    } else {
                        const data = localStorage.getItem(key);
                        return data ? JSON.parse(data) : null;
                    }
                } catch (error) {
                    console.error('è·å–æ•°æ®å¤±è´¥:', error);
                    try {
                        const localData = localStorage.getItem(key);
                        if (localData) {
                            console.log('å·²å›é€€åˆ°æœ¬åœ°å­˜å‚¨');
                            return JSON.parse(localData);
                        }
                    } catch (e) {
                        console.error('æœ¬åœ°å­˜å‚¨è¯»å–å¤±è´¥:', e);
                    }
                    return null;
                }
            },

            // åˆ é™¤æ•°æ®
            async remove(key) {
                try {
                    if (cloudConfig.storageType === 'github' && cloudConfig.githubToken && cloudConfig.githubRepo) {
                        const path = `data/${key}.json`;
                        const existingData = await this.getFileContent(path);
                        
                        if (existingData) {
                            const response = await fetch(`${this.apiBase}/repos/${cloudConfig.githubRepo}/contents/${path}`, {
                                method: 'DELETE',
                                headers: {
                                    'Authorization': `token ${cloudConfig.githubToken}`,
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    message: `åˆ é™¤${key} - ${new Date().toISOString()}`,
                                    sha: existingData.sha,
                                    branch: cloudConfig.githubBranch
                                })
                            });
                            
                            if (response.ok) {
                                console.log(`ä»GitHubåˆ é™¤æ•°æ®: ${key}`);
                                localStorage.removeItem(key);
                                return true;
                            }
                        }
                    } else if (cloudConfig.storageType === 'customApi' && cloudConfig.apiEndpoint) {
                        const response = await fetch(cloudConfig.apiEndpoint + '/remove?key=' + key, {
                            method: 'DELETE'
                        });
                        return response.ok;
                    }
                    
                    localStorage.removeItem(key);
                    console.log(`ä»æœ¬åœ°åˆ é™¤æ•°æ®: ${key}`);
                    return true;
                } catch (error) {
                    console.error('åˆ é™¤æ•°æ®å¤±è´¥:', error);
                    return false;
                }
            }
        };
        
        // ç”¨æˆ·æ•°æ®
        let currentUser = null;
        let orders = [];
        let currentOrder = null;
        let selectedSpec = null;
        
        // ç®¡ç†å‘˜å¯†ç 
        const ADMIN_PASSWORD = "admin123";
        
        // DOMå…ƒç´ 
        const loading = document.getElementById('loading');
        const gameNameModal = document.getElementById('gameNameModal');
        const gameNameInput = document.getElementById('gameNameInput');
        const gameNameConfirmBtn = document.getElementById('gameNameConfirmBtn');
        const serverModal = document.getElementById('serverModal');
        const serverSelect = document.getElementById('serverSelect');
        const serverConfirmBtn = document.getElementById('serverConfirmBtn');
        const mainContainer = document.getElementById('mainContainer');
        const userNameElement = document.getElementById('userName');
        const userServerElement = document.getElementById('userServer');
        const logoutBtn = document.getElementById('logoutBtn');
        const ordersGrid = document.getElementById('ordersGrid');
        const categoryOrdersGrid = document.getElementById('categoryOrdersGrid');
        const categories = document.querySelectorAll('.category');
        const navItems = document.querySelectorAll('.nav-item');
        const pages = document.querySelectorAll('.page');
        const orderModal = document.getElementById('orderModal');
        const orderModalTitle = document.getElementById('orderModalTitle');
        const specsModal = document.getElementById('specsModal');
        const confirmOrderBtn = document.getElementById('confirmOrderBtn');
        const cancelOrderBtn = document.getElementById('cancelOrderBtn');
        const paymentModal = document.getElementById('paymentModal');
        const paymentAmount = document.getElementById('paymentAmount');
        const paymentConfirmBtn = document.getElementById('paymentConfirmBtn');
        const paymentCloseBtn = document.getElementById('paymentCloseBtn');
        const reviewModal = document.getElementById('reviewModal');
        const reviewTitle = document.getElementById('reviewTitle');
        const reviewMessage = document.getElementById('reviewMessage');
        const reviewCloseBtn = document.getElementById('reviewCloseBtn');
        const userOrdersList = document.getElementById('userOrdersList');
        const adminBtn = document.getElementById('adminBtn');
        const adminPasswordModal = document.getElementById('adminPasswordModal');
        const adminPasswordInput = document.getElementById('adminPassword');
        const adminPasswordBtn = document.getElementById('adminPasswordBtn');
        const adminModal = document.getElementById('adminModal');
        const userList = document.getElementById('userList');
        const adminOrderList = document.getElementById('adminOrderList');
        const adminCloseBtn = document.getElementById('adminCloseBtn');
        const adminRefreshBtn = document.getElementById('adminRefreshBtn');
        const orderLoading = document.getElementById('orderLoading');
        
        // åˆå§‹åŒ–
        async function init() {
            try {
                console.log('å¼€å§‹åˆå§‹åŒ–åº”ç”¨...');
                sessionStorage.removeItem('tempGameName');
                
                const savedUser = localStorage.getItem('currentUser');
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    console.log('å‘ç°å·²ç™»å½•ç”¨æˆ·:', currentUser.name);
                    showMainApp();
                } else {
                    console.log('æœªå‘ç°ç™»å½•ç”¨æˆ·ï¼Œæ˜¾ç¤ºç™»å½•ç•Œé¢');
                    gameNameModal.style.display = 'flex';
                }
                
                generateOrders();
                generateCategoryOrders();
                
                if (currentUser) {
                    updateUserOrders();
                    setupOrderNotifications();
                }
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                alert('åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                gameNameModal.style.display = 'flex';
            } finally {
                loading.style.display = 'none';
            }
        }
        
        // ç”Ÿæˆè®¢å•æ•°æ®ï¼ˆåŒ…å«ä»·æ ¼ä¿¡æ¯ï¼‰
        function getOrderData() {
            return [
                { 
                    title: "ä¼ ä¸–æ­¦å™¨è½¬ç›˜", 
                    desc: "åŒ…å«å¤šç§ä¼ ä¸–æ­¦å™¨ï¼Œæå‡æˆ˜æ–—åŠ›", 
                    category: "equipment", 
                    specs: [
                        { name: "ç«‹å³ä¸‹å•(éœ€åŠ å®¢æœå¾®ä¿¡æŠ½å¥–)", price: 1, originalPrice: 15 }
                    ] 
                },
                { 
                    title: "åˆ®åœ°çš®å•", 
                    desc: "å†°æ²³ç¦åŒºåŸºç¡€åˆ®åœ°çš®ï¼Œ1å…ƒä¿100ä¸‡", 
                    category: "skin", 
                    specs: [
                        { name: "ä¸€ä¿ä¸€ã€ä¿100ä¸‡+6åŒ…ã€‘", price: 1, originalPrice: 12 },
                        { name: "äºŒä¿ä¸€ã€ä¿200ä¸‡+è½¬ç›˜ã€‘", price: 5.9, originalPrice: 30 },
                        { name: "ä¸‰ä¿ä¸€ã€ä¿300ä¸‡+è½¬ç›˜*2ã€‘", price: 7.9, originalPrice: 80 }
                    ] 
                },
                { 
                    title: "VIPä¼šå‘˜å¥—é¤", 
                    desc: "VIPç‰¹æƒï¼Œäº«å—å°Šè´µä½“éªŒï¼Œå…è´¹æŠ¤èˆª2æ¬¡", 
                    category: "vip", 
                    specs: [
                        { name: "æœˆå¡", price: 15, originalPrice: 25 },
                        { name: "å­£å¡", price: 40, originalPrice: 60 },
                        { name: "å¹´å¡", price: 120, originalPrice: 180 }
                    ] 
                },
                { 
                    title: "èµŒé‡‘å•", 
                    desc: "å‡º8æ ¹é‡‘æ¡ï¼Œé€1æŠŠä¼ ä¸–æ­¦å™¨", 
                    category: "other", 
                    specs: [
                        { name: "ä¸€ä¿ä¸€ã€ä¿100ä¸‡+7å¥—ã€‘", price: 7.9, originalPrice: 8 },
                        { name: "äºŒä¿ä¸€ã€ä¿200ä¸‡+7å¥—+éšæœºé‡‘ã€‘", price: 18.9, originalPrice: 30 },
                        { name: "ä¸‰ä¿ä¸€ã€ä¿400ä¸‡+7å¥—+éšæœºé‡‘*2+æŠ½å¥–ã€‘", price: 19.9, originalPrice: 50 }
                    ] 
                },
                { 
                    title: "çº¯å®åŠ›æŠ¤", 
                    desc: "çº¯æœ‰å®åŠ›çš„æŠ¤èˆª", 
                    category: "equipment", 
                    specs: [
                        { name: "ä¸€ä¿ä¸€ã€ä¿100ä¸‡+7å¥—+éšæœºé‡‘ã€‘", price: 10, originalPrice: 18 },
                        { name: "äºŒä¿ä¸€ã€ä¿300ä¸‡+7å¥—+éšæœºé‡‘+æŠ½å¥–*2ã€‘", price: 19.9, originalPrice: 45 },
                        { name: "ä¸‰ä¿ä¸€ã€ä¿400ä¸‡+7å¥—+éšæœºé‡‘+æŠ½å¥–*3ã€‘", price: 26.9, originalPrice: 90 }
                    ] 
                },
                { 
                    title: "è€é¼ å•", 
                    desc: "ä½¿ç”¨è€é¼ æ‰“æ³•æŠ¤èˆª", 
                    category: "other", 
                    specs: [
                        { name: "ä¸€ä¿ä¸€ã€ä¿100ä¸‡+6å¥—ã€‘", price: 3, originalPrice: 12 },
                        { name: "äºŒä¿ä¸€ã€ä¿150ä¸‡+éšæœºé‡‘+æŠ½å¥–ã€‘", price: 7.9, originalPrice: 30 },
                        { name: "ä¸‰ä¿ä¸€ã€éšæœºé‡‘*2+è½¬ç›˜*3ã€‘", price: 13.9, originalPrice: 50 }
                    ] 
                },
                { 
                    title: "ä¸»æ’­æŠ¤", 
                    desc: "æ¸¸é¾™äº²è‡ªæŠ¤èˆª", 
                    category: "equipment", 
                    specs: [
                        { name: "ä¿200ä¸‡ã€é€7å¥—+éšæœºé‡‘+ç¥ç¦è¯­ã€‘", price: 16.9, originalPrice: 25 }
                    ] 
                },
                { 
                    title: "æ·˜æ±°äººæœºå•", 
                    desc: "1å›¾æ¯æ·˜æ±°ä¸€ä¸ªäººæœºæŠ¤èˆª+10ä¸‡ï¼Œæ·˜æ±°çœŸäºº+30ä¸‡", 
                    category: "other", 
                    specs: [
                        { name: "ä¿åº•100ä¸‡", price: 19.9, originalPrice: 15 },
                        { name: "ä¿åº•200ä¸‡", price: 23.9, originalPrice: 45 },
                        { name: "ä¿åº•300ä¸‡", price: 29.9, originalPrice: 100 }
                    ] 
                },
                { 
                    title: "èµŒ2é‡‘å•", 
                    desc: "ä¸€å±€æ²¡æœ‰å‡ºã€2æ ¹é‡‘æ¡ã€‘ä¸€ç›´æŠ¤", 
                    category: "skin", 
                    specs: [
                        { name: "ä¸€ä¿ä¸€ã€é€7å¥—+é‡‘+æŠ½å¥–ã€‘", price: 29.9, originalPrice: 20 },
                        { name: "äºŒä¿ä¸€ã€é€7å¥—+é‡‘+æŠ½å¥–*2ã€‘", price: 49.9, originalPrice: 50 },
                        { name: "ä¸‰ä¿ä¸€ã€é€7å¥—+é‡‘*2+æŠ½å¥–*5ã€‘", price: 59.9, originalPrice: 110 }
                    ] 
                },
                { 
                    title: "èµŒæ©™å•", 
                    desc: "ä¸€å±€æ²¡å‡ºæ©™è‰²å˜å–ç‰©ä¸€ç›´æŠ¤", 
                    category: "equipment", 
                    specs: [
                        { name: "ä¸€ä¿ä¸€ã€é€7å¥—+éšæœºé‡‘ã€‘", price: 29.9, originalPrice: 12 },
                        { name: "äºŒä¿ä¸€ã€é€7å¥—+éšæœºé‡‘+æŠ½å¥–*2ã€‘", price: 49.9, originalPrice: 30 },
                        { name: "ä¸‰ä¿ä¸€ã€é€7å¥—+éšæœºé‡‘*2+æŠ½å¥–*5ã€‘", price: 59.9, originalPrice: 45 }
                    ] 
                }
            ];
        }
        
        // è®¡ç®—ä»·æ ¼èŒƒå›´
        function getPriceRange(specs) {
            if (!specs || specs.length === 0) return "ä»·æ ¼å¾…å®š";
            
            const prices = specs.map(spec => spec.price);
            const minPrice = Math.min(...prices);
            const maxPrice = Math.max(...prices);
            
            if (minPrice === maxPrice) {
                return `Â¥${minPrice}`;
            } else {
                return `Â¥${minPrice} - Â¥${maxPrice}`;
            }
        }
        
        // è®¡ç®—åŸä»·èŒƒå›´
        function getOriginalPriceRange(specs) {
            if (!specs || specs.length === 0) return "";
            
            const originalPrices = specs.map(spec => spec.originalPrice);
            const minOriginalPrice = Math.min(...originalPrices);
            const maxOriginalPrice = Math.max(...originalPrices);
            
            if (minOriginalPrice === maxOriginalPrice) {
                return `åŸä»·: Â¥${minOriginalPrice}`;
            } else {
                return `åŸä»·: Â¥${minOriginalPrice} - Â¥${maxOriginalPrice}`;
            }
        }
        
        // ç”Ÿæˆè®¢å•æ•°æ®
        function generateOrders() {
            const orderData = getOrderData();
            
            ordersGrid.innerHTML = '';
            
            orderData.forEach((order, index) => {
                const priceRange = getPriceRange(order.specs);
                const originalPriceRange = getOriginalPriceRange(order.specs);
                
                const orderCard = document.createElement('div');
                orderCard.className = 'order-card';
                orderCard.innerHTML = `
                    <div class="order-title">${order.title}</div>
                    <div class="order-price-range">${priceRange}</div>
                    <div class="order-original-price">${originalPriceRange}</div>
                    <div class="order-desc">${order.desc}</div>
                    <button class="order-btn" data-order="${index}">ç«‹å³ä¸‹å•</button>
                `;
                ordersGrid.appendChild(orderCard);
            });
            
            document.querySelectorAll('.order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderIndex = parseInt(this.dataset.order);
                    showOrderModal(orderIndex);
                });
            });
        }
        
        // ç”Ÿæˆåˆ†ç±»è®¢å•
        function generateCategoryOrders() {
            const orderData = getOrderData();
            
            categoryOrdersGrid.innerHTML = '';
            filterOrdersByCategory('all');
            
            categories.forEach(category => {
                category.addEventListener('click', function() {
                    const categoryType = this.dataset.category;
                    categories.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    filterOrdersByCategory(categoryType);
                });
            });
        }
        
        // æ ¹æ®åˆ†ç±»è¿‡æ»¤è®¢å•
        function filterOrdersByCategory(category) {
            const orderData = getOrderData();
            categoryOrdersGrid.innerHTML = '';
            
            let filteredOrders = orderData;
            if (category !== 'all') {
                filteredOrders = orderData.filter(order => order.category === category);
            }
            
            filteredOrders.forEach((order, index) => {
                const priceRange = getPriceRange(order.specs);
                const originalPriceRange = getOriginalPriceRange(order.specs);
                
                const orderCard = document.createElement('div');
                orderCard.className = 'order-card';
                orderCard.innerHTML = `
                    <div class="order-title">${order.title}</div>
                    <div class="order-price-range">${priceRange}</div>
                    <div class="order-original-price">${originalPriceRange}</div>
                    <div class="order-desc">${order.desc}</div>
                    <button class="order-btn" data-order="${orderData.indexOf(order)}">ç«‹å³ä¸‹å•</button>
                `;
                categoryOrdersGrid.appendChild(orderCard);
            });
            
            document.querySelectorAll('#categoryOrdersGrid .order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderIndex = parseInt(this.dataset.order);
                    showOrderModal(orderIndex);
                });
            });
        }
        
        // æ˜¾ç¤ºä¸‹å•å¼¹çª—
        function showOrderModal(orderIndex) {
            const orderData = getOrderData();
            const order = orderData[orderIndex];
            
            currentOrder = order;
            orderModalTitle.textContent = order.title;
            
            specsModal.innerHTML = '';
            order.specs.forEach((spec, index) => {
                const specElement = document.createElement('div');
                specElement.className = 'spec-modal';
                specElement.dataset.spec = index;
                specElement.dataset.price = spec.price;
                specElement.innerHTML = `
                    <div class="spec-name">${spec.name}</div>
                    <div class="spec-price">Â¥${spec.price}</div>
                `;
                specsModal.appendChild(specElement);
            });
            
            document.querySelectorAll('.spec-modal').forEach(spec => {
                spec.addEventListener('click', function() {
                    document.querySelectorAll('.spec-modal').forEach(s => s.classList.remove('active'));
                    this.classList.add('active');
                    selectedSpec = parseInt(this.dataset.spec);
                });
            });
            
            orderModal.style.display = 'flex';
        }
        
        // æ˜¾ç¤ºä¸»åº”ç”¨
        async function showMainApp() {
            console.log('æ˜¾ç¤ºä¸»åº”ç”¨ç•Œé¢');
            gameNameModal.style.display = 'none';
            serverModal.style.display = 'none';
            mainContainer.style.display = 'block';
            
            userNameElement.textContent = currentUser.name;
            userServerElement.textContent = `åŒºæœ: ${currentUser.server}`;
            
            setTimeout(() => {
                showReviewMessage('æ¬¢è¿', `æ¬¢è¿å›æ¥ï¼Œ${currentUser.name}ï¼`);
            }, 1000);
        }
        
        // æ˜¾ç¤ºå®¡æ ¸æ¶ˆæ¯
        function showReviewMessage(title, message) {
            reviewTitle.textContent = title;
            reviewMessage.textContent = message;
            reviewModal.style.display = 'flex';
        }
        
        // æ˜¾ç¤ºæ”¯ä»˜å¼¹çª—
        function showPaymentModal(order, spec) {
            const specData = order.specs[spec];
            const amount = specData.price;
            
            paymentAmount.textContent = `Â¥${amount}`;
            document.getElementById('paymentAmountText').textContent = `Â¥${amount}`;
            paymentModal.style.display = 'flex';
        }
        
        // æ˜¾ç¤ºè®¢å•åŠ è½½åŠ¨ç”»
        function showOrderLoading() {
            orderLoading.style.display = 'flex';
        }
        
        // éšè—è®¢å•åŠ è½½åŠ¨ç”»
        function hideOrderLoading() {
            orderLoading.style.display = 'none';
        }
        
        // æ›´æ–°ç”¨æˆ·è®¢å•
        async function updateUserOrders() {
            try {
                userOrdersList.innerHTML = '<div class="status-card"><div class="status-desc">æ­£åœ¨åŠ è½½è®¢å•...</div></div>';
                
                const allOrders = await storageManager.get('orders') || [];
                const userOrders = allOrders.filter(order => order.userId === currentUser.id);
                
                userOrdersList.innerHTML = '';
                
                if (userOrders.length === 0) {
                    userOrdersList.innerHTML = '<div class="status-card"><div class="status-desc">æš‚æ— è®¢å•</div></div>';
                    return;
                }
                
                userOrders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                userOrders.forEach(order => {
                    const statusCard = document.createElement('div');
                    statusCard.className = 'status-card';
                    
                    let statusText = '';
                    if (order.status === 'pending') {
                        statusText = 'çŠ¶æ€: æ­£åœ¨å®¡æ ¸ä¸­';
                    } else if (order.status === 'approved') {
                        statusText = 'çŠ¶æ€: å®¡æ ¸é€šè¿‡';
                    } else {
                        statusText = `çŠ¶æ€: å®¡æ ¸æœªé€šè¿‡ - ç†ç”±: ${order.reason || 'ä¿¡æ¯ä¸å®Œæ•´'}`;
                    }
                    
                    const formattedTime = order.timestamp ? new Date(order.timestamp).toLocaleString() : 'æœªçŸ¥æ—¶é—´';
                    
                    statusCard.innerHTML = `
                        <div class="status-title">${order.orderTitle} - ${order.spec}</div>
                        <div class="status-desc">è®¢å•é‡‘é¢: Â¥${order.price}</div>
                        <div class="status-desc">${statusText}</div>
                        <div class="status-desc">ä¸‹å•æ—¶é—´: ${formattedTime}</div>
                    `;
                    userOrdersList.appendChild(statusCard);
                });
            } catch (error) {
                console.error('æ›´æ–°ç”¨æˆ·è®¢å•å¤±è´¥:', error);
                userOrdersList.innerHTML = `
                    <div class="status-card">
                        <div class="status-desc">åŠ è½½è®¢å•å¤±è´¥: ${error.message}</div>
                        <button class="modal-btn" style="width: auto; margin-top: 10px;" onclick="loadMockOrders()">æŸ¥çœ‹æ¼”ç¤ºæ•°æ®</button>
                    </div>
                `;
            }
        }
        
        // åŠ è½½æ¨¡æ‹Ÿè®¢å•æ•°æ®
        function loadMockOrders() {
            const mockOrders = [
                {
                    id: 'mock-1',
                    orderTitle: 'é«˜çº§è£…å¤‡ç¤¼åŒ…',
                    spec: 'æ ‡å‡†ç‰ˆ(3ä»¶)',
                    price: 25,
                    status: 'approved',
                    timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000)
                },
                {
                    id: 'mock-2',
                    orderTitle: 'ç¨€æœ‰çš®è‚¤æŠ½å¥–',
                    spec: 'ç¨€æœ‰çš®è‚¤',
                    price: 20,
                    status: 'pending',
                    timestamp: new Date(Date.now() - 30 * 60 * 1000)
                },
                {
                    id: 'mock-3',
                    orderTitle: 'VIPä¼šå‘˜å¥—é¤',
                    spec: 'æœˆå¡',
                    price: 15,
                    status: 'rejected',
                    reason: 'ä¿¡æ¯ä¸å®Œæ•´ï¼Œè¯·æä¾›æ›´å¤šè¯¦æƒ…',
                    timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000)
                }
            ];
            
            userOrdersList.innerHTML = '';
            
            mockOrders.forEach(order => {
                const statusCard = document.createElement('div');
                statusCard.className = 'status-card';
                
                let statusText = '';
                if (order.status === 'pending') {
                    statusText = 'çŠ¶æ€: æ­£åœ¨å®¡æ ¸ä¸­ï¼ˆæ¼”ç¤ºæ•°æ®ï¼‰';
                } else if (order.status === 'approved') {
                    statusText = 'çŠ¶æ€: å®¡æ ¸é€šè¿‡ï¼ˆæ¼”ç¤ºæ•°æ®ï¼‰';
                } else {
                    statusText = `çŠ¶æ€: å®¡æ ¸æœªé€šè¿‡ï¼ˆæ¼”ç¤ºæ•°æ®ï¼‰ - ç†ç”±: ${order.reason || 'ä¿¡æ¯ä¸å®Œæ•´'}`;
                }
                
                statusCard.innerHTML = `
                    <div class="status-title">${order.orderTitle} - ${order.spec}</div>
                    <div class="status-desc">è®¢å•é‡‘é¢: Â¥${order.price}</div>
                    <div class="status-desc">${statusText}</div>
                    <div class="status-desc">ä¸‹å•æ—¶é—´: ${order.timestamp.toLocaleString()}</div>
                `;
                userOrdersList.appendChild(statusCard);
            });
        }
        
        // è®¾ç½®è®¢å•é€šçŸ¥ç›‘å¬
        function setupOrderNotifications() {
            if (!currentUser) return;
            
            const checkOrderStatus = async () => {
                try {
                    const allOrders = await storageManager.get('orders') || [];
                    const userOrders = allOrders.filter(order => order.userId === currentUser.id);
                    
                    userOrders.forEach(order => {
                        const localOrders = JSON.parse(localStorage.getItem('localOrders') || '{}');
                        const oldStatus = localOrders[order.id];
                        
                        if (oldStatus && oldStatus !== order.status) {
                            if (order.status === 'approved') {
                                showReviewMessage('å®¡æ ¸é€šè¿‡', 'æ‚¨çš„è®¢å•å·²é€šè¿‡å®¡æ ¸ï¼');
                            } else if (order.status === 'rejected') {
                                showReviewMessage('å®¡æ ¸æœªé€šè¿‡', `æ‚¨çš„è®¢å•æœªé€šè¿‡å®¡æ ¸ï¼Œç†ç”±: ${order.reason || 'ä¿¡æ¯ä¸ç¬¦åˆè¦æ±‚'}`);
                            }
                        }
                        
                        localOrders[order.id] = order.status;
                        localStorage.setItem('localOrders', JSON.stringify(localOrders));
                    });
                } catch (error) {
                    console.error('æ£€æŸ¥è®¢å•çŠ¶æ€å¤±è´¥:', error);
                }
            };
            
            setInterval(checkOrderStatus, 30000);
            checkOrderStatus();
        }
        
        // æ›´æ–°åå°ç®¡ç†ç•Œé¢
        async function updateAdminPanel() {
            try {
                userList.innerHTML = '<div class="user-item">æ­£åœ¨åŠ è½½ç”¨æˆ·æ•°æ®...</div>';
                adminOrderList.innerHTML = '<div class="order-item">æ­£åœ¨åŠ è½½è®¢å•æ•°æ®...</div>';
                
                const allUsers = await storageManager.get('users') || [];
                
                userList.innerHTML = '';
                
                if (allUsers.length === 0) {
                    userList.innerHTML = '<div class="user-item">æš‚æ— ç”¨æˆ·æ•°æ®</div>';
                } else {
                    allUsers.forEach(user => {
                        const userItem = document.createElement('div');
                        userItem.className = 'user-item';
                        
                        const formattedTime = user.registerTime ? new Date(user.registerTime).toLocaleString() : 'æœªçŸ¥æ—¶é—´';
                        
                        userItem.innerHTML = `
                            <div><strong>${user.name}</strong> - ${user.server}</div>
                            <div>æ³¨å†Œæ—¶é—´: ${formattedTime}</div>
                        `;
                        userList.appendChild(userItem);
                    });
                }
                
                adminOrderList.innerHTML = '';
                const allOrders = await storageManager.get('orders') || [];
                
                if (allOrders.length === 0) {
                    adminOrderList.innerHTML = '<div class="order-item">æš‚æ— è®¢å•æ•°æ®</div>';
                } else {
                    allOrders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    
                    allOrders.forEach(order => {
                        const orderItem = document.createElement('div');
                        orderItem.className = 'order-item';
                        
                        const formattedTime = order.timestamp ? new Date(order.timestamp).toLocaleString() : 'æœªçŸ¥æ—¶é—´';
                        
                        orderItem.innerHTML = `
                            <div><strong>è®¢å• #${order.id}</strong></div>
                            <div>ç”¨æˆ·: ${order.userName} (${order.userServer})</div>
                            <div>å•†å“: ${order.orderTitle} - ${order.spec}</div>
                            <div>é‡‘é¢: Â¥${order.price}</div>
                            <div>æ—¶é—´: ${formattedTime}</div>
                            <div>çŠ¶æ€: ${order.status === 'pending' ? 'å®¡æ ¸ä¸­' : order.status === 'approved' ? 'å·²é€šè¿‡' : 'æœªé€šè¿‡'}</div>
                            ${order.status === 'pending' ? `
                                <div class="order-actions">
                                    <button class="approve-btn" data-order="${order.id}">é€šè¿‡</button>
                                    <button class="reject-btn" data-order="${order.id}">æ‹’ç»</button>
                                </div>
                            ` : ''}
                        `;
                        adminOrderList.appendChild(orderItem);
                    });
                    
                    document.querySelectorAll('.approve-btn').forEach(btn => {
                        btn.addEventListener('click', async function() {
                            const orderId = this.dataset.order;
                            try {
                                const allOrders = await storageManager.get('orders') || [];
                                const orderIndex = allOrders.findIndex(order => order.id === orderId);
                                
                                if (orderIndex !== -1) {
                                    allOrders[orderIndex].status = 'approved';
                                    allOrders[orderIndex].updatedAt = new Date().toISOString();
                                    
                                    await storageManager.save('orders', allOrders);
                                    updateAdminPanel();
                                    
                                    const order = allOrders[orderIndex];
                                    if (currentUser && order.userId === currentUser.id) {
                                        updateUserOrders();
                                        showReviewMessage('å®¡æ ¸é€šè¿‡', 'æ‚¨çš„è®¢å•å·²é€šè¿‡å®¡æ ¸ï¼');
                                    }
                                    
                                    alert('å®¡æ ¸é€šè¿‡ï¼');
                                }
                            } catch (error) {
                                console.error('å®¡æ ¸è®¢å•å¤±è´¥:', error);
                                alert('å®¡æ ¸å¤±è´¥ï¼Œè¯·é‡è¯•');
                            }
                        });
                    });
                    
                    document.querySelectorAll('.reject-btn').forEach(btn => {
                        btn.addEventListener('click', async function() {
                            const orderId = this.dataset.order;
                            const reason = prompt('è¯·è¾“å…¥æ‹’ç»ç†ç”±:', 'ä¿¡æ¯ä¸ç¬¦åˆè¦æ±‚');
                            
                            if (reason === null) return;
                            
                            try {
                                const allOrders = await storageManager.get('orders') || [];
                                const orderIndex = allOrders.findIndex(order => order.id === orderId);
                                
                                if (orderIndex !== -1) {
                                    allOrders[orderIndex].status = 'rejected';
                                    allOrders[orderIndex].reason = reason;
                                    allOrders[orderIndex].updatedAt = new Date().toISOString();
                                    
                                    await storageManager.save('orders', allOrders);
                                    updateAdminPanel();
                                    
                                    const order = allOrders[orderIndex];
                                    if (currentUser && order.userId === currentUser.id) {
                                        updateUserOrders();
                                        showReviewMessage('å®¡æ ¸æœªé€šè¿‡', `æ‚¨çš„è®¢å•æœªé€šè¿‡å®¡æ ¸ï¼Œç†ç”±: ${reason}`);
                                    }
                                    
                                    alert('å·²æ‹’ç»è®¢å•ï¼');
                                }
                            } catch (error) {
                                console.error('æ‹’ç»è®¢å•å¤±è´¥:', error);
                                alert('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•');
                            }
                        });
                    });
                }
            } catch (error) {
                console.error('æ›´æ–°åå°é¢æ¿å¤±è´¥:', error);
                userList.innerHTML = '<div class="user-item">åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥</div>';
                adminOrderList.innerHTML = '<div class="order-item">åŠ è½½è®¢å•æ•°æ®å¤±è´¥</div>';
                alert('åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }
        
        // æ¸¸æˆåç§°å¼¹çª—ç¡®è®¤äº‹ä»¶
        gameNameConfirmBtn.addEventListener('click', function() {
            const name = gameNameInput.value.trim();
            if (!name) {
                alert('è¯·è¾“å…¥æ¸¸æˆåç§°');
                return;
            }
            console.log('æ¸¸æˆåç§°è¾“å…¥:', name);
            sessionStorage.setItem('tempGameName', name);
            gameNameModal.style.display = 'none';
            serverModal.style.display = 'flex';
        });
        
        // åŒºæœå¼¹çª—ç¡®è®¤äº‹ä»¶
        serverConfirmBtn.addEventListener('click', async function() {
            const server = serverSelect.value;
            const name = sessionStorage.getItem('tempGameName');
            
            console.log('åŒºæœé€‰æ‹©:', server);
            console.log('æ¸¸æˆåç§°:', name);
            
            if (!server) {
                alert('è¯·é€‰æ‹©åŒºæœ');
                return;
            }
            
            if (!name) {
                alert('æ¸¸æˆåç§°ä¸¢å¤±ï¼Œè¯·é‡æ–°è¾“å…¥');
                serverModal.style.display = 'none';
                gameNameModal.style.display = 'flex';
                return;
            }
            
            try {
                loading.style.display = 'flex';
                
                const userData = {
                    id: 'user-' + Date.now(),
                    name: name,
                    server: server,
                    registerTime: new Date().toISOString()
                };
                
                const allUsers = await storageManager.get('users') || [];
                allUsers.push(userData);
                await storageManager.save('users', allUsers);
                
                currentUser = userData;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                sessionStorage.removeItem('tempGameName');
                
                serverModal.style.display = 'none';
                showMainApp();
                console.log('ç”¨æˆ·ç™»å½•æˆåŠŸ');
            } catch (error) {
                console.error('åˆ›å»ºç”¨æˆ·å¤±è´¥:', error);
                alert('ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•');
            } finally {
                loading.style.display = 'none';
            }
        });
        
        // é€€å‡ºç™»å½•äº‹ä»¶
        logoutBtn.addEventListener('click', async function() {
            try {
                localStorage.removeItem('currentUser');
                localStorage.removeItem('localOrders');
                currentUser = null;
                
                mainContainer.style.display = 'none';
                gameNameModal.style.display = 'flex';
                
                gameNameInput.value = '';
                serverSelect.value = '';
            } catch (error) {
                console.error('é€€å‡ºç™»å½•å¤±è´¥:', error);
                alert('é€€å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        });
        
        // å¯¼èˆªåˆ‡æ¢
        navItems.forEach(item => {
            item.addEventListener('click', function() {
                const pageId = this.dataset.page;
                
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
                
                pages.forEach(page => page.classList.remove('active'));
                document.getElementById(pageId).classList.add('active');
                
                if (pageId === 'profilePage' && currentUser) {
                    updateUserOrders();
                }
            });
        });
        
        // ç¡®è®¤ä¸‹å•
        confirmOrderBtn.addEventListener('click', async function() {
            const selectedSpecElement = document.querySelector('.spec-modal.active');
            
            if (!selectedSpecElement) {
                alert('è¯·é€‰æ‹©ä¸€ä¸ªè§„æ ¼');
                return;
            }
            
            try {
                const specData = currentOrder.specs[selectedSpec];
                
                // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
                showOrderLoading();
                
                // ä¿å­˜è®¢å•æ•°æ®åˆ°æœåŠ¡å™¨
                const orderData = {
                    id: 'order-' + Date.now(),
                    userId: currentUser.id,
                    userName: currentUser.name,
                    userServer: currentUser.server,
                    orderTitle: currentOrder.title,
                    spec: specData.name,
                    price: specData.price,
                    originalPrice: specData.originalPrice,
                    status: 'pending',
                    timestamp: new Date().toISOString()
                };
                
                console.log('æ­£åœ¨åˆ›å»ºè®¢å•...', orderData);
                
                // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼Œå±•ç¤ºåŠ è½½æ•ˆæœ
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                const allOrders = await storageManager.get('orders') || [];
                allOrders.push(orderData);
                const saveResult = await storageManager.save('orders', allOrders);
                
                if (!saveResult) {
                    throw new Error('ä¿å­˜è®¢å•åˆ°æœåŠ¡å™¨å¤±è´¥');
                }
                
                console.log('è®¢å•åˆ›å»ºæˆåŠŸï¼ŒID:', orderData.id);
                
                // å…³é—­åŠ è½½åŠ¨ç”»
                hideOrderLoading();
                
                // å…³é—­ä¸‹å•å¼¹çª—ï¼Œæ˜¾ç¤ºæ”¯ä»˜å¼¹çª—
                orderModal.style.display = 'none';
                showPaymentModal(currentOrder, selectedSpec);
                
                // æ›´æ–°ç”¨æˆ·è®¢å•åˆ—è¡¨
                await updateUserOrders();
            } catch (error) {
                console.error('åˆ›å»ºè®¢å•å¤±è´¥:', error);
                // å…³é—­åŠ è½½åŠ¨ç”»
                hideOrderLoading();
                alert('ä¸‹å•å¤±è´¥: ' + error.message);
            }
        });
        
        // å–æ¶ˆä¸‹å•
        cancelOrderBtn.addEventListener('click', function() {
            orderModal.style.display = 'none';
            selectedSpec = null;
        });
        
        // æ”¯ä»˜ç¡®è®¤
        paymentConfirmBtn.addEventListener('click', function() {
            paymentModal.style.display = 'none';
            showReviewMessage('æ”¯ä»˜æˆåŠŸ', 'æ‚¨çš„è®¢å•æ”¯ä»˜æˆåŠŸï¼Œæ­£åœ¨ç­‰å¾…å®¡æ ¸ï¼');
            selectedSpec = null;
        });
        
        // æ”¯ä»˜å–æ¶ˆ
        paymentCloseBtn.addEventListener('click', function() {
            paymentModal.style.display = 'none';
            selectedSpec = null;
        });
        
        // å®¡æ ¸å¼¹çª—å…³é—­
        reviewCloseBtn.addEventListener('click', function() {
            reviewModal.style.display = 'none';
        });
        
        // åå°ç®¡ç†æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        adminBtn.addEventListener('click', function() {
            adminPasswordModal.style.display = 'flex';
        });
        
        // åå°å¯†ç éªŒè¯
        adminPasswordBtn.addEventListener('click', function() {
            const password = adminPasswordInput.value;
            
            if (password === ADMIN_PASSWORD) {
                adminPasswordModal.style.display = 'none';
                adminModal.style.display = 'flex';
                adminPasswordInput.value = '';
                updateAdminPanel();
            } else {
                alert('å¯†ç é”™è¯¯ï¼');
                adminPasswordInput.value = '';
            }
        });
        
        // åå°åˆ·æ–°æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        adminRefreshBtn.addEventListener('click', async function() {
            // æ·»åŠ ç‚¹å‡»åé¦ˆ
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fa fa-refresh fa-spin" style="margin-right: 5px;"></i>åˆ·æ–°ä¸­...';
            this.disabled = true;
            
            try {
                await updateAdminPanel();
                // çŸ­æš‚æ˜¾ç¤ºæˆåŠŸæç¤º
                const originalBackground = this.style.background;
                this.style.background = '#4CAF50';
                setTimeout(() => {
                    this.style.background = originalBackground;
                }, 300);
            } catch (error) {
                console.error('åˆ·æ–°åå°æ•°æ®å¤±è´¥:', error);
            } finally {
                setTimeout(() => {
                    this.innerHTML = originalText;
                    this.disabled = false;
                }, 500);
            }
        });
        
        adminCloseBtn.addEventListener('click', function() {
            adminModal.style.display = 'none';
        });
        
        // æ·»åŠ åå°å¯†ç å¼¹çª—å…³é—­æŒ‰é’®äº‹ä»¶
        document.getElementById('adminPasswordCloseBtn').addEventListener('click', function() {
            adminPasswordModal.style.display = 'none';
        });
        
        // æ·»åŠ ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­åŠŸèƒ½
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        });
        
        // åˆå§‹åŒ–åº”ç”¨
        init();
    </script>

</body></html>
